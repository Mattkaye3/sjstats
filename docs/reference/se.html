<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Standard Error for variables or coefficients — se • sjstats</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Standard Error for variables or coefficients — se" />

<meta property="og:description" content="Compute standard error for a variable, for all variables
    of a data frame, for joint random and fixed effects
    coefficients of (non-/linear) mixed models, the adjusted
    standard errors for generalized linear (mixed) models, or
    for intraclass correlation coefficients (ICC)." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sjstats</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.17.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/anova-statistics.html">Statistics for Anova Tables</a>
    </li>
    <li>
      <a href="../articles/bayesian-statistics.html">Statistics for Bayesian Models</a>
    </li>
    <li>
      <a href="../articles/mixedmodels-statistics.html">Statistics for Mixed Effects Models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/strengejacke/sjstats">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Standard Error for variables or coefficients</h1>
    <small class="dont-index">Source: <a href='https://github.com/strengejacke/sjstats/blob/master/R/se.R'><code>R/se.R</code></a></small>
    <div class="hidden name"><code>se.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Compute standard error for a variable, for all variables
    of a data frame, for joint random and fixed effects
    coefficients of (non-/linear) mixed models, the adjusted
    standard errors for generalized linear (mixed) models, or
    for intraclass correlation coefficients (ICC).</p>
    
    </div>

    <pre class="usage"><span class='fu'>se</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for icc.lme4</span>
<span class='fu'>se</span>(<span class='no'>x</span>, <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>(Numeric) vector, a data frame, an <code>lm</code>, <code>glm</code>,
<code>merMod</code> (<span class="pkg">lme4</span>), or <code>stanreg</code> model object, an ICC object
(as obtained by the <code><a href='icc.html'>icc</a></code>-function), a <code>table</code> or
<code>xtabs</code> object, or a list with estimate and p-value. For the latter
case, the list must contain elements named <code>estimate</code> and
<code>p.value</code> (see 'Examples' and 'Details').</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Currently not used.</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>Numeric, the number of simulations for calculating the
standard error for intraclass correlation coefficients, as
obtained by the <code><a href='icc.html'>icc</a></code>-function.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The standard error of <code>x</code>.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><strong>Standard error for variables</strong>
  <br /> <br />
  For variables and data frames, the standard error is the square root of the
  variance divided by the number of observations (length of vector).
  <br /> <br />
  <strong>Standard error for mixed models</strong>
  <br /> <br />
  For linear mixed models, and generalized linear mixed models, this
  function computes the standard errors for joint (sums of) random and fixed
  effects coefficients (unlike <code><a href='http://www.rdocumentation.org/packages/arm/topics/se.coef'>se.coef</a></code>, which returns the
  standard error for fixed and random effects separately). Hence, <code>se()</code>
  returns the appropriate standard errors for <code><a href='http://www.rdocumentation.org/packages/lme4/topics/merMod-class'>coef.merMod</a></code>.
  <br /> <br />
  <strong>Standard error for generalized linear models</strong>
  <br /> <br />
  For generalized linear models, approximated standard errors, using the delta
  method for transformed regression parameters are returned (Oehlert 1992).
  <br /> <br />
  <strong>Standard error for Intraclass Correlation Coefficient (ICC)</strong>
  <br /> <br />
  The standard error for the <code><a href='icc.html'>icc</a></code> is based on bootstrapping,
  thus, the <code>nsim</code>-argument is required. See 'Examples'.
  <br /> <br />
  <strong>Standard error for proportions and mean value</strong>
  <br /> <br />
  To compute the standard error for relative frequencies (i.e. proportions, or
  mean value if <code>x</code> has only two categories), this vector must be supplied
  as table, e.g. <code>se(table(iris$Species))</code>. <code>se()</code> than computes the
  relative frequencies (proportions) for each value and the related standard
  error for each value. This might be useful to add standard errors or confidence
  intervals to descriptive statistics. If standard errors for weighted variables
  are required, use <code>xtabs()</code>, e.g. <code>se(xtabs(weights ~ variable))</code>.
  <br /> <br />
  <strong>Standard error for regression coefficient and p-value</strong>
  <br /> <br />
  <code>se()</code> also returns the standard error of an estimate (regression
  coefficient) and p-value, assuming a normal distribution to compute
  the z-score from the p-value (formula in short: <code>b / qnorm(p / 2)</code>).
  See 'Examples'.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Computation of standard errors for coefficients of mixed models
   is based <a href='http://stackoverflow.com/questions/26198958/extracting-coefficients-and-their-standard-error-from-lme'>on this code</a>.
   Standard errors for generalized linear (mixed) models, if
   <code>type = "re"</code>, are approximations based on the delta
   method (Oehlert 1992).
   <br /> <br />
   A remark on standard errors:
   &#8220;Standard error represents variation in the point estimate, but
   confidence interval has usual Bayesian interpretation only with flat prior.&#8221;
   (Gelman 2017)</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Oehlert GW. 1992. A note on the delta method. American Statistician 46(1).
            <br /> <br />
            Gelman A 2017. How to interpret confidence intervals? <a href='http://andrewgelman.com/2017/03/04/interpret-confidence-intervals/'>http://andrewgelman.com/2017/03/04/interpret-confidence-intervals/</a></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='no'>lme4</span>)
<span class='fu'>library</span>(<span class='no'>sjmisc</span>)

<span class='co'># compute standard error for vector</span>
<span class='fu'>se</span>(<span class='fu'>rnorm</span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>mean</span> <span class='kw'>=</span> <span class='fl'>3</span>))</div><div class='output co'>#&gt; [1] 0.1074613</div><div class='input'>
<span class='co'># compute standard error for each variable in a data frame</span>
<span class='fu'>data</span>(<span class='no'>efc</span>)
<span class='fu'>se</span>(<span class='no'>efc</span>[, <span class='fl'>1</span>:<span class='fl'>3</span>])</div><div class='output co'>#&gt;    c12hour   e15relat     e16sex 
#&gt; 1.69162290 0.06942207 0.01565588 </div><div class='input'>
<span class='co'># compute standard error for merMod-coefficients</span>
<span class='fu'>library</span>(<span class='no'>lme4</span>)
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lme4/topics/lmer'>lmer</a></span>(<span class='no'>Reaction</span> ~ <span class='no'>Days</span> + (<span class='no'>Days</span> <span class='kw'>|</span> <span class='no'>Subject</span>), <span class='no'>sleepstudy</span>)
<span class='fu'>se</span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; $Subject
#&gt;    (Intercept)   Days
#&gt; 1     13.86649 2.7752
#&gt; 2     13.86649 2.7752
#&gt; 3     13.86649 2.7752
#&gt; 4     13.86649 2.7752
#&gt; 5     13.86649 2.7752
#&gt; 6     13.86649 2.7752
#&gt; 7     13.86649 2.7752
#&gt; 8     13.86649 2.7752
#&gt; 9     13.86649 2.7752
#&gt; 10    13.86649 2.7752
#&gt; 11    13.86649 2.7752
#&gt; 12    13.86649 2.7752
#&gt; 13    13.86649 2.7752
#&gt; 14    13.86649 2.7752
#&gt; 15    13.86649 2.7752
#&gt; 16    13.86649 2.7752
#&gt; 17    13.86649 2.7752
#&gt; 18    13.86649 2.7752
#&gt; </div><div class='input'>
<span class='co'># compute odds-ratio adjusted standard errors, based on delta method</span>
<span class='co'># with first-order Taylor approximation.</span>
<span class='fu'>data</span>(<span class='no'>efc</span>)
<span class='no'>efc</span>$<span class='no'>services</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sjmisc</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/sjmisc/topics/dicho'>dicho</a></span>(<span class='no'>efc</span>$<span class='no'>tot_sc_e</span>, <span class='kw'>dich.by</span> <span class='kw'>=</span> <span class='fl'>0</span>)
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>glm</span>(
  <span class='no'>services</span> ~ <span class='no'>neg_c_7</span> + <span class='no'>c161sex</span> + <span class='no'>e42dep</span>,
  <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>efc</span>,
  <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'>binomial</span>(<span class='kw'>link</span> <span class='kw'>=</span> <span class='st'>"logit"</span>)
)
<span class='fu'>se</span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; # A tibble: 4 x 3
#&gt;   term        estimate std.error
#&gt;   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;
#&gt; 1 (Intercept)    0.595    0.224 
#&gt; 2 neg_c_7        1.04     0.0204
#&gt; 3 c161sex        0.803    0.130 
#&gt; 4 e42dep         1.24     0.0972</div><div class='input'>
<span class='co'># compute odds-ratio adjusted standard errors for generalized</span>
<span class='co'># linear mixed model, also based on delta method</span>

<span class='co'># create binary response</span>
<span class='no'>sleepstudy</span>$<span class='no'>Reaction.dicho</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/sjmisc/topics/dicho'>dicho</a></span>(<span class='no'>sleepstudy</span>$<span class='no'>Reaction</span>, <span class='kw'>dich.by</span> <span class='kw'>=</span> <span class='st'>"median"</span>)
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/lme4/topics/glmer'>glmer</a></span>(
  <span class='no'>Reaction.dicho</span> ~ <span class='no'>Days</span> + (<span class='no'>Days</span> <span class='kw'>|</span> <span class='no'>Subject</span>),
  <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>sleepstudy</span>,
  <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'>binomial</span>(<span class='st'>"logit"</span>)
)
<span class='fu'>se</span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; $Subject
#&gt;    (Intercept)      Days
#&gt; 1     1.859251 0.4700877
#&gt; 2     2.622321 0.4115004
#&gt; 3     2.622321 0.4115004
#&gt; 4     1.633616 0.3289753
#&gt; 5     1.745522 0.4826391
#&gt; 6     1.714059 0.3560052
#&gt; 7     1.715195 0.4646524
#&gt; 8     2.219966 0.4133501
#&gt; 9     2.622321 0.4115004
#&gt; 10    1.806673 0.5077360
#&gt; 11    2.314690 0.3959941
#&gt; 12    2.111495 0.4335945
#&gt; 13    1.830037 0.3388438
#&gt; 14    1.686571 0.4933028
#&gt; 15    1.988285 0.4534415
#&gt; 16    2.167228 0.4013762
#&gt; 17    2.314690 0.3959941
#&gt; 18    1.778644 0.4321839
#&gt; </div><div class='input'>
<span class='co'># compute standard error for proportions</span>
<span class='no'>efc</span>$<span class='no'>e42dep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/sjmisc/topics/to_label'>to_label</a></span>(<span class='no'>efc</span>$<span class='no'>e42dep</span>)
<span class='fu'>se</span>(<span class='fu'>table</span>(<span class='no'>efc</span>$<span class='no'>e42dep</span>))</div><div class='output co'>#&gt;                  value proportion   std.error
#&gt; 1          independent 0.07325194 0.008680166
#&gt; 2   slightly dependent 0.24972253 0.014420404
#&gt; 3 moderately dependent 0.33962264 0.015777276
#&gt; 4   severely dependent 0.33740289 0.015752039</div><div class='input'>
<span class='co'># including weights</span>
<span class='no'>efc</span>$<span class='no'>weights</span> <span class='kw'>&lt;-</span> <span class='fu'>rnorm</span>(<span class='fu'>nrow</span>(<span class='no'>efc</span>), <span class='fl'>1</span>, <span class='fl'>.25</span>)
<span class='fu'>se</span>(<span class='fu'>xtabs</span>(<span class='no'>efc</span>$<span class='no'>weights</span> ~ <span class='no'>efc</span>$<span class='no'>e42dep</span>))</div><div class='output co'>#&gt;                  value proportion  std.error
#&gt; 1          independent 0.07898613 0.00900256
#&gt; 2   slightly dependent 0.24649213 0.01438477
#&gt; 3 moderately dependent 0.33359206 0.01573749
#&gt; 4   severely dependent 0.34092968 0.01582180</div><div class='input'>
<span class='co'># compute standard error from regression coefficient and p-value</span>
<span class='fu'>se</span>(<span class='fu'>list</span>(<span class='kw'>estimate</span> <span class='kw'>=</span> <span class='fl'>.3</span>, <span class='kw'>p.value</span> <span class='kw'>=</span> <span class='fl'>.002</span>))</div><div class='output co'>#&gt; [1] 0.09708008</div><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='co'># compute standard error of ICC for the linear mixed model</span>
<span class='fu'><a href='icc.html'>icc</a></span>(<span class='no'>fit</span>)
<span class='fu'>se</span>(<span class='fu'><a href='icc.html'>icc</a></span>(<span class='no'>fit</span>))

<span class='co'># the standard error for the ICC can be computed manually in this way,</span>
<span class='co'># taking the fitted model example from above</span>
<span class='fu'>library</span>(<span class='no'>dplyr</span>)
<span class='fu'>library</span>(<span class='no'>purrr</span>)
<span class='no'>dummy</span> <span class='kw'>&lt;-</span> <span class='no'>sleepstudy</span> <span class='kw'>%&gt;%</span>
  <span class='co'># generate 100 bootstrap replicates of dataset</span>
  <span class='fu'><a href='bootstrap.html'>bootstrap</a></span>(<span class='fl'>100</span>) <span class='kw'>%&gt;%</span>
  <span class='co'># run mixed effects regression on each bootstrap replicate</span>
  <span class='co'># and compute ICC for each "bootstrapped" regression</span>
  <span class='fu'><a href='http://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span>(
    <span class='kw'>models</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/purrr/topics/map'>map</a></span>(<span class='no'>strap</span>, ~<span class='fu'><a href='http://www.rdocumentation.org/packages/lme4/topics/lmer'>lmer</a></span>(<span class='no'>Reaction</span> ~ <span class='no'>Days</span> + (<span class='no'>Days</span> <span class='kw'>|</span> <span class='no'>Subject</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>.x</span>)),
    <span class='kw'>icc</span> <span class='kw'>=</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/purrr/topics/map'>map_dbl</a></span>(<span class='no'>models</span>, ~<span class='fu'><a href='icc.html'>icc</a></span>(<span class='no'>.x</span>))
  )

<span class='co'># now compute SE and p-values for the bootstrapped ICC, values</span>
<span class='co'># may differ from above example due to random seed</span>
<span class='fu'><a href='boot_ci.html'>boot_se</a></span>(<span class='no'>dummy</span>, <span class='no'>icc</span>)
<span class='fu'><a href='boot_ci.html'>boot_p</a></span>(<span class='no'>dummy</span>, <span class='no'>icc</span>)
<span class='co'># }</span><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Daniel Lüdecke.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

